package hello; import jakarta.servlet.ServletConfig; import jakarta.servlet.ServletException; import jakarta.servlet.annotation.WebServlet; import jakarta.servlet.http.HttpServlet; import jakarta.servlet.http.HttpServletRequest; import jakarta.servlet.http.HttpServletResponse;
import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.io.OutputStream; import java.io.OutputStreamWriter; import java.io.PrintWriter; import java.net.HttpURLConnection; import java.net.URL; public class
HelloServlet extends HttpServlet { private static final long serialVersionUID = 1L; public void init(ServletConfig config) throws ServletException { System.out.println("init 메서드 호출"); } // protected void service (HttpServletRequest request, HttpServletResponse
response) throws ServletException, IOException { // response.getWriter().println("Served at: " + request.getContextPath()); // response.setContentType("text/html; charset-utf-8"); // response.getWriter().println("
<h1>안녕 서블릿</h1>"); // } protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { response.getWriter().println("Served at: " + request.getContextPath()); try { URL url = new URL("https://samsung-api.lifree1.com/auth");
HttpURLConnection con = (HttpURLConnection) url.openConnection(); con.setConnectTimeout(5000); //서버에 연결되는 Timeout 시간 설정 con.setReadTimeout(5000); // InputStream 읽어 오는 Timeout 시간 설정 con.addRequestProperty("accessKeyId", "samsung01"); //key값 설정 con.addRequestProperty("secretAccessKey",
"9wrgJBPE8rjqTZYwklckwSI10A6MZTXE"); //key값 설정 con.setRequestProperty("Content-Type", "application/json"); con.setRequestMethod("POST"); con.setDoInput(true); con.setDoOutput(true); //POST 데이터를 OutputStream으로 넘겨 주겠다는 설정 con.setUseCaches(false); con.setDefaultUseCaches(false);
response.getWriter().println("requestMethod: " + con.getRequestMethod()); String jsonMessage=""; //json으로 message를 전달하고자 할 때 OutputStreamWriter wr = new OutputStreamWriter(con.getOutputStream()); wr.write(jsonMessage); //json 형식의 message 전달 wr.flush();
response.getWriter().println("ResponseCode: " + con.getResponseCode()); StringBuilder sb = new StringBuilder(); if (con.getResponseCode() == HttpURLConnection.HTTP_OK) { response.getWriter().println("requestMethod: " + con.getRequestMethod()); //Stream을
처리해줘야 하는 귀찮음이 있음. BufferedReader br = new BufferedReader( new InputStreamReader(con.getInputStream(), "utf-8")); String line; while ((line = br.readLine()) != null) { sb.append(line).append("\n"); } br.close(); System.out.println("http error = " + sb.toString());
} else { System.out.println("connection errorMessage = " + con.getResponseMessage()); } } catch (Exception e){ System.err.println(e.toString()); } } }